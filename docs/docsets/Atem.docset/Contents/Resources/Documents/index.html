<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Atem  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Atem  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Atem Docs</a> (55% documented)</p>
        <p class="header-right"><a href="https://github.com/Dev1an/Swift-Atem"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Atem Reference</a>
        <img id="carat" src="img/carat.png" />
        Atem  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/ConnectionState.html">ConnectionState</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ContextualMessageHandler.html">ContextualMessageHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Controller.html">Controller</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/s:4Atem13MessageParserC">MessageParser</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PureMessageHandler.html">PureMessageHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Switcher.html">Switcher</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/AtemSize.html">AtemSize</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Model.html">Model</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource.html">VideoSource</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource/Kind.html">â€“ Kind</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource/ExternalInterfaces.html">â€“ ExternalInterfaces</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource/Availability.html">â€“ Availability</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource/MixEffects.html">â€“ MixEffects</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/VideoSource/PropertiesChanged.html">â€“ PropertiesChanged</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Array.html">Array</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/ArraySlice.html">ArraySlice</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Collection.html">Collection</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CountablePartialRangeFrom.html">CountablePartialRangeFrom</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CountableRange.html">CountableRange</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/FixedWidthInteger.html">FixedWidthInteger</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/OptionSet.html">OptionSet</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/RawRepresentable.html">RawRepresentable</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt16.html">UInt16</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt32.html">UInt32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt8.html">UInt8</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:4Atem06encodeA06string6lengthSays5UInt8VGSS_SitKF">encodeAtem(string:length:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/ControllerConnection.html">ControllerConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Message.html">Message</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Serializable.html">Serializable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SingleValueDescribable.html">SingleValueDescribable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SwitcherConnections.html">SwitcherConnections</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/AuxiliaryOutputChanged.html">AuxiliaryOutputChanged</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ChangeAuxiliaryOutput.html">ChangeAuxiliaryOutput</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ChangePreviewBus.html">ChangePreviewBus</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ChangeProgramBus.html">ChangeProgramBus</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ChangeTransitionPosition.html">ChangeTransitionPosition</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DoCut.html">DoCut</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/InitiationComplete.html">InitiationComplete</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/LockChange.html">LockChange</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/LockObtained.html">LockObtained</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/LockPositionRequest.html">LockPositionRequest</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/LockRequest.html">LockRequest</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MediaPoolConfiguration.html">MediaPoolConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MessageTitle.html">MessageTitle</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MixEffectConfiguration.html">MixEffectConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MultiViewConfiguration.html">MultiViewConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/NewTimecode.html">NewTimecode</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/PreviewBusChanged.html">PreviewBusChanged</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ProductInfo.html">ProductInfo</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ProgramBusChanged.html">ProgramBusChanged</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ProtocolVersion.html">ProtocolVersion</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SourceTallies.html">SourceTallies</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TallyLight.html">TallyLight</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Topology.html">Topology</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TransitionPositionChanged.html">TransitionPositionChanged</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <p align="center">
    <img src="https://img.shields.io/badge/swift-5.1-orange.svg" alt="Swift 5.1">
    <img src="https://img.shields.io/badge/Platform-macOS%20%7C%20Linux-brightgreen.svg" alt="Platforms: macOS & Linux">
</p>
<h1 id='atem-network-protocol-implementation' class='heading'>Atem network protocol implementation</h1>

<p>Implementation of BlackMagicDesign&rsquo;s ATEM communication protocol in Swift. It is written on top of Apple&rsquo;s  networking library <a href="https://github.com/apple/swift-nio">NIO</a> and implements both sides of the protocol: the control panel and the switcher side. This means that you can not only use it to control atem switchers but also to connect to your control panels without the need for a switcher. Opening a whole new world of applications for the Atem control panels. An example can be found at <a href="https://github.com/Dev1an/Atem-Simulator">Atem-Simulator</a></p>

<p>Starting from version 1.0.0 this package uses Swift 5 and NIO2.</p>
<h3 id='tested-platforms' class='heading'>Tested platforms</h3>

<ul>
<li>macOS 10.14.6 on a MacBook Pro retina 15&quot; late 2013</li>
<li>Raspbian GNU/Linux 9 stretch on a Raspberry Pi model 3 B</li>
</ul>
<h2 id='installation' class='heading'>Installation</h2>

<p>When starting a new project: create a Swift package via <a href="https://swift.org/package-manager/">SPM</a></p>
<pre class="highlight shell"><code><span class="c"># Shell</span>
<span class="o">&gt;</span> swift package init <span class="c"># --type empty|library|executable|system-module</span>
</code></pre>

<p>Then add this library to the <a href="https://github.com/apple/swift-package-manager/blob/master/Documentation/PackageDescriptionV4.md#dependencies">package description</a>&rsquo;s dependencies</p>
<pre class="highlight swift"><code><span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Dev1an/Swift-Atem"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"1.0.0"</span><span class="p">)</span>
</code></pre>

<p>And resolve this new dependency</p>
<pre class="highlight shell"><code><span class="c"># Shell</span>
<span class="o">&gt;</span> swift package resolve
</code></pre>

<p>Finally import the <code>Atem</code> module in your code</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Atem</span>
</code></pre>

<p>You are now ready to create atem controllers and switchers ðŸ˜Ž !</p>
<h2 id='usage' class='heading'>Usage</h2>

<p>After looking at the following examples, study the <a href="https://dev1an.github.io/Swift-Atem/">API reference</a> for more details.</p>
<h3 id='controller' class='heading'>Controller</h3>

<p>This example shows how to create a controller that connects to a swicther at ip address 10.1.0.67 and print a message whenever the preview bus changes.</p>
<pre class="highlight swift"><code><span class="k">try</span> <span class="kt">Controller</span><span class="p">(</span><span class="nv">ipAddress</span><span class="p">:</span> <span class="n">address</span><span class="p">)</span> <span class="p">{</span> <span class="n">connection</span> <span class="k">in</span>
  <span class="n">connection</span><span class="o">.</span><span class="n">when</span><span class="p">{</span> <span class="p">(</span><span class="nv">change</span><span class="p">:</span> <span class="kt">PreviewBusChanged</span><span class="p">)</span> <span class="k">in</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">change</span><span class="p">)</span> <span class="c1">// prints: 'Preview bus changed to input(x)'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><strong>Sending messages</strong></p>

<p>To send a message to the switcher use the <code>send(...)</code> method like this:</p>
<pre class="highlight swift"><code><span class="n">controller</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">message</span><span class="p">:</span> <span class="kt">ChangeTransitionPosition</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="mi">5000</span><span class="p">))</span>
</code></pre>
<h3 id='switcher' class='heading'>Switcher</h3>

<p>The following example shows how to emulate the basic functionality of an atem switcher. It will forward incoming messages containing transition and preview &amp; program bus changes to the connected controller.</p>

<p>This snippet is also included in a seperate SPM target &ldquo;Simulator&rdquo; (./Sources/Simulator) and can be run by simply executing <code>swift run simulator</code> in the terminal.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">switcher</span> <span class="o">=</span> <span class="kt">Switcher</span> <span class="p">{</span> <span class="n">controllers</span> <span class="k">in</span>
  <span class="n">controllers</span><span class="o">.</span><span class="n">when</span> <span class="p">{</span> <span class="p">(</span><span class="nv">change</span><span class="p">:</span> <span class="kt">ChangePreviewBus</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">in</span>
    <span class="n">controllers</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span>
      <span class="kt">PreviewBusChanged</span><span class="p">(</span>
        <span class="nv">to</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">previewBus</span><span class="p">,</span>
        <span class="nv">mixEffect</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">mixEffect</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">}</span>
  <span class="n">controllers</span><span class="o">.</span><span class="n">when</span><span class="p">{</span> <span class="p">(</span><span class="nv">change</span><span class="p">:</span> <span class="kt">ChangeProgramBus</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">in</span>
        <span class="n">controllers</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span>
      <span class="kt">ProgramBusChanged</span><span class="p">(</span>
        <span class="nv">to</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">programBus</span><span class="p">,</span>
        <span class="nv">mixEffect</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">mixEffect</span>
      <span class="p">)</span>
    <span class="p">)</span>
    <span class="p">}</span>
  <span class="n">controllers</span><span class="o">.</span><span class="n">when</span> <span class="p">{</span> <span class="p">(</span><span class="nv">change</span><span class="p">:</span> <span class="kt">ChangeTransitionPosition</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">in</span>
        <span class="n">controllers</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span>
      <span class="kt">TransitionPositionChanged</span><span class="p">(</span>
        <span class="nv">to</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
        <span class="nv">remainingFrames</span><span class="p">:</span> <span class="mi">250</span> <span class="o">-</span> <span class="kt">UInt8</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">position</span><span class="o">/</span><span class="mi">40</span><span class="p">),</span>
        <span class="nv">mixEffect</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">mixEffect</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">}</span>
    <span class="n">controllers</span><span class="o">.</span><span class="n">when</span> <span class="p">{</span> <span class="p">(</span><span class="nv">change</span><span class="p">:</span> <span class="kt">ChangeAuxiliaryOutput</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">in</span>
        <span class="n">controllers</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span>
      <span class="kt">AuxiliaryOutputChanged</span><span class="p">(</span>
        <span class="nv">source</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
        <span class="nv">output</span><span class="p">:</span> <span class="n">change</span><span class="o">.</span><span class="n">output</span>
      <span class="p">)</span>
    <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2020-04-21)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy â™ªâ™« v0.13.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
